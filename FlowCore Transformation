BiocManager::install("flowCore")
library("flowCore")
fcs_files = list.files('./02_data', pattern='\\.fcs$', full.names = TRUE)
flow_set = read.flowSet(fcs_files)

marker_names = colnames(flow_set)
transformation <- arcsinhTransform()
transform_list <- transformList(from = marker_names, tfun = transformation)
transformed_flowset <- transform_list %on% flow_set

View(exprs(transformed_flowset[[1]]))

data = data.frame()
for (i in 1:length(transformed_flowset)) {
  sample_name = basename(fcs_files)[i]
  sample_name = gsub("\\.fcs$", "", sample_name)
  sample_data = data.frame(exprs(transformed_flowset[[i]]))
  sample_data$sample = sample_name
  data = rbind(data, sample_data)
}
markernames = markernames(transformed_flowset)
colnames(data) = c("Time" ,markernames,"sample")
